version: 1.0.{build}
image: Visual Studio 2019
environment:
  matrix:
    - PYTHON: "C:\\Python311-x64"
    - PYTHON: "C:\\Python310-x64"
    - PYTHON: "C:\\Python39-x64"
    - PYTHON: "C:\\Python38-x64"

install:
  - "SET PATH=%PYTHON%;%PYTHON%\\Scripts;%PATH%"
  - "python -m pip install --upgrade pip"
  - "python --version"
  - "pip --version"
  # Download and unzip liblsl
  - "powershell Invoke-WebRequest -Uri 'https://github.com/sccn/liblsl/releases/download/v1.16.2/liblsl-1.16.2-Win_amd64.zip' -OutFile 'liblsl.zip'"
  - "unzip -o liblsl.zip -d liblsl"
  # Move the DLL to the correct directory
  - "move liblsl\\bin\\lsl.dll %PYTHON%\\Lib\\site-packages\\"
  # Set the PYLSL_LIB environment variable
  - "set PYLSL_LIB=%PYTHON%\\Lib\\site-packages\\lsl.dll"
  # Install other dependencies
  - "python setup.py install"
  - "pip install --upgrade urllib3>=2.0.5"  # Moved to this position
  - "pip install pytest"

build: off

test_script:
  - "pytest Tests/"
